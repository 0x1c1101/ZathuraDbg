        -:    0:Source:/home/rc/ZathuraDbg/src/app/windows/stackWindow.cpp
        -:    0:Graph:/home/rc/ZathuraDbg/src/cmake-build-debug-coverage/CMakeFiles/Zathura.dir/app/windows/stackWindow.cpp.gcno
        -:    0:Data:/home/rc/ZathuraDbg/src/cmake-build-debug-coverage/CMakeFiles/Zathura.dir/app/windows/stackWindow.cpp.gcda
        -:    0:Runs:1
        -:    1:#include "windows.hpp"
        -:    2:MemoryEditor stackEditor;
        -:    3:
function _ZL13copyBigEndianPvPKvm called 102 returned 100% blocks executed 100%
      102:    4:static void* copyBigEndian(void* _dst, const void* _src, size_t s)
        -:    5:{
      102:    6:    uint8_t* dst = (uint8_t*)_dst;
      102:    7:    const uint8_t* src = (const uint8_t*)_src + s - 1;
534773862:    8:    for (size_t i = 0; i < s; ++i)
      102:    8-block 2
534773862:    8-block 4
branch  0 taken 534773760
branch  1 taken 102 (fallthrough)
        -:    9:    {
534773760:   10:        dst[i] = *src--;
534773760:   10-block 3
        -:   11:    }
      102:   12:    return _dst;
      102:   12-block 5
        -:   13:}
        -:   14:
function _Z14stackWriteFuncPhmh called 0 returned 0% blocks executed 0%
    #####:   15:void stackWriteFunc(ImU8* data, const size_t offset, const ImU8 delta) {
    #####:   16:    LOG_INFO("Stack is being written to...");
    %%%%%:   16-block 2
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed
    %%%%%:   16-block 4
call    3 never executed
branch  4 never executed (fallthrough)
branch  5 never executed
    %%%%%:   16-block 6
call    6 never executed
branch  7 never executed (fallthrough)
branch  8 never executed (throw)
    %%%%%:   16-block 7
call    9 never executed
branch 10 never executed (fallthrough)
branch 11 never executed (throw)
    %%%%%:   16-block 8
call   12 never executed
call   13 never executed
call   14 never executed
branch 15 never executed (fallthrough)
branch 16 never executed (throw)
    %%%%%:   16-block 11
call   17 never executed
branch 18 never executed (fallthrough)
branch 19 never executed (throw)
    %%%%%:   16-block 12
    %%%%%:   16-block 14
call   20 never executed
branch 21 never executed (fallthrough)
branch 22 never executed (throw)
    %%%%%:   16-block 15
call   23 never executed
branch 24 never executed (fallthrough)
branch 25 never executed (throw)
    %%%%%:   16-block 16
call   26 never executed
branch 27 never executed (fallthrough)
branch 28 never executed (throw)
    %%%%%:   16-block 17
call   29 never executed
branch 30 never executed (fallthrough)
branch 31 never executed (throw)
    %%%%%:   16-block 18
call   32 never executed
branch 33 never executed (fallthrough)
branch 34 never executed (throw)
    %%%%%:   16-block 19
call   35 never executed
branch 36 never executed (fallthrough)
branch 37 never executed (throw)
    %%%%%:   16-block 20
call   38 never executed
call   39 never executed
    %%%%%:   16-block 23
call   40 never executed
call   41 never executed
    %%%%%:   16-block 26
call   42 never executed
branch 43 never executed
branch 44 never executed (fallthrough)
    $$$$$:   16-block 87
call   45 never executed
    $$$$$:   16-block 89
call   46 never executed
    $$$$$:   16-block 93
    $$$$$:   16-block 94
    $$$$$:   16-block 95
    $$$$$:   16-block 96
call   47 never executed
    $$$$$:   16-block 98
    $$$$$:   16-block 99
call   48 never executed
    $$$$$:   16-block 101
    #####:   17:    auto err = uc_mem_write(uc, STACK_ADDRESS + STACK_SIZE - offset - 1, &delta, 1);
    %%%%%:   17-block 28
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed (throw)
        -:   18:
    #####:   19:    if (err) {
    %%%%%:   19-block 29
branch  0 never executed (fallthrough)
branch  1 never executed
    #####:   20:        LOG_ERROR("Failed to write to memory. Address: " << std::hex << STACK_ADDRESS + offset);
    %%%%%:   20-block 30
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed
    %%%%%:   20-block 32
call    3 never executed
branch  4 never executed (fallthrough)
branch  5 never executed
    %%%%%:   20-block 34
call    6 never executed
branch  7 never executed (fallthrough)
branch  8 never executed (throw)
    %%%%%:   20-block 35
call    9 never executed
branch 10 never executed (fallthrough)
branch 11 never executed (throw)
    %%%%%:   20-block 36
call   12 never executed
call   13 never executed
call   14 never executed
branch 15 never executed (fallthrough)
branch 16 never executed (throw)
    %%%%%:   20-block 39
call   17 never executed
branch 18 never executed (fallthrough)
branch 19 never executed (throw)
    %%%%%:   20-block 40
    %%%%%:   20-block 42
call   20 never executed
branch 21 never executed (fallthrough)
branch 22 never executed (throw)
    %%%%%:   20-block 43
call   23 never executed
branch 24 never executed (fallthrough)
branch 25 never executed (throw)
    %%%%%:   20-block 44
call   26 never executed
branch 27 never executed (fallthrough)
branch 28 never executed (throw)
    %%%%%:   20-block 45
call   29 never executed
branch 30 never executed (fallthrough)
branch 31 never executed (throw)
    %%%%%:   20-block 46
call   32 never executed
branch 33 never executed (fallthrough)
branch 34 never executed (throw)
    %%%%%:   20-block 47
call   35 never executed
branch 36 never executed (fallthrough)
branch 37 never executed (throw)
    %%%%%:   20-block 48
call   38 never executed
branch 39 never executed (fallthrough)
branch 40 never executed (throw)
    %%%%%:   20-block 49
call   41 never executed
branch 42 never executed (fallthrough)
branch 43 never executed (throw)
    %%%%%:   20-block 50
call   44 never executed
call   45 never executed
    %%%%%:   20-block 53
call   46 never executed
call   47 never executed
    %%%%%:   20-block 56
call   48 never executed
branch 49 never executed
branch 50 never executed (fallthrough)
    $$$$$:   20-block 102
call   51 never executed
    $$$$$:   20-block 104
call   52 never executed
    $$$$$:   20-block 108
    $$$$$:   20-block 109
    $$$$$:   20-block 110
    $$$$$:   20-block 111
call   53 never executed
    $$$$$:   20-block 113
    $$$$$:   20-block 114
call   54 never executed
    $$$$$:   20-block 116
    #####:   21:        tinyfd_messageBox("ERROR!", "Failed to write to the memory address!!", "ok", "error", 0);
    %%%%%:   21-block 58
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed (throw)
        -:   22:    }
        -:   23:
        -:   24:    char hex[90];
    #####:   25:    snprintf(hex, sizeof(hex), "Data change after stack operation: %x", delta);
    %%%%%:   25-block 59
    #####:   26:    LOG_DEBUG(hex);
    %%%%%:   26-block 60
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed
    %%%%%:   26-block 62
call    3 never executed
branch  4 never executed (fallthrough)
branch  5 never executed
    %%%%%:   26-block 64
call    6 never executed
branch  7 never executed (fallthrough)
branch  8 never executed (throw)
    %%%%%:   26-block 65
call    9 never executed
branch 10 never executed (fallthrough)
branch 11 never executed (throw)
    %%%%%:   26-block 66
call   12 never executed
call   13 never executed
call   14 never executed
branch 15 never executed (fallthrough)
branch 16 never executed (throw)
    %%%%%:   26-block 69
call   17 never executed
branch 18 never executed (fallthrough)
branch 19 never executed (throw)
    %%%%%:   26-block 70
    %%%%%:   26-block 72
call   20 never executed
branch 21 never executed (fallthrough)
branch 22 never executed (throw)
    %%%%%:   26-block 73
call   23 never executed
branch 24 never executed (fallthrough)
branch 25 never executed (throw)
    %%%%%:   26-block 74
call   26 never executed
branch 27 never executed (fallthrough)
branch 28 never executed (throw)
    %%%%%:   26-block 75
call   29 never executed
branch 30 never executed (fallthrough)
branch 31 never executed (throw)
    %%%%%:   26-block 76
call   32 never executed
branch 33 never executed (fallthrough)
branch 34 never executed (throw)
    %%%%%:   26-block 77
call   35 never executed
branch 36 never executed (fallthrough)
branch 37 never executed (throw)
    %%%%%:   26-block 78
call   38 never executed
call   39 never executed
    %%%%%:   26-block 81
call   40 never executed
call   41 never executed
    %%%%%:   26-block 84
call   42 never executed
branch 43 never executed
branch 44 never executed (fallthrough)
    $$$$$:   26-block 117
call   45 never executed
    $$$$$:   26-block 119
call   46 never executed
    $$$$$:   26-block 123
    $$$$$:   26-block 124
    $$$$$:   26-block 125
    $$$$$:   26-block 126
call   47 never executed
    $$$$$:   26-block 128
    $$$$$:   26-block 129
call   48 never executed
    $$$$$:   26-block 131
    #####:   27:}
    %%%%%:   27-block 86
        -:   28:
        -:   29:uint64_t stackErrorAddr = 0;
        -:   30:bool showPopupError = false;
function _Z15stackErrorPopupv called 0 returned 0% blocks executed 0%
    #####:   31:bool stackErrorPopup(){
    #####:   32:   bool map= tinyfd_messageBox("Stack in unmapped memory!", "The stack value you have set is not mapped by default. Do you want to map it?", "okcancel", "error", 0);
    %%%%%:   32-block 2
call    0 never executed
    #####:   33:   if (map)
branch  0 never executed (fallthrough)
branch  1 never executed
        -:   34:    {
    #####:   35:        uc_mem_map(uc, STACK_ADDRESS, STACK_SIZE, UC_PROT_ALL);
    %%%%%:   35-block 4
call    0 never executed
    #####:   36:        showPopupError = false;
    #####:   37:        return true;
        -:   38:    }
        -:   39:
    #####:   40:    return false;
    %%%%%:   40-block 6
        -:   41:}
        -:   42:
        -:   43:static char data[5 * 1024 * 1024];
        -:   44:static char temp[5 * 1024 * 1024];
        -:   45:
        -:   46:bool stackArraysZeroed = false;
function _Z17stackEditorWindowv called 1077 returned 100% blocks executed 27%
     1077:   47:void stackEditorWindow() {
     1077:   48:    const auto io = ImGui::GetIO();
     1077:   48-block 2
call    0 returned 1077
branch  1 taken 1077 (fallthrough)
branch  2 taken 0 (throw)
     1077:   48-block 3
call    3 returned 1077
branch  4 taken 1077 (fallthrough)
branch  5 taken 0 (throw)
     1077:   49:    ImGui::PushFont(io.Fonts->Fonts[3]);
     1077:   49-block 4
call    0 returned 1077
call    1 returned 1077
branch  2 taken 1077 (fallthrough)
branch  3 taken 0 (throw)
        -:   50:  
     1077:   51:    if (!uc) {
     1077:   51-block 6
branch  0 taken 0 (fallthrough)
branch  1 taken 1077
    #####:   52:        ImGui::PopFont();
    %%%%%:   52-block 7
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed (throw)
    #####:   53:        return;
    %%%%%:   53-block 8
        -:   54:    }
        -:   55:
     1077:   56:    if (!stackArraysZeroed) {
     1077:   56-block 9
branch  0 taken 3 (fallthrough)
branch  1 taken 1074
        3:   57:         memset(data, 0, sizeof(data));
        3:   58:         memset(temp, 0, sizeof(temp));
        3:   59:         stackArraysZeroed = true;
        3:   59-block 10
        -:   60:    }
        -:   61:
     1077:   62:    const auto err = uc_mem_read(uc, STACK_ADDRESS, temp, STACK_SIZE);
     1077:   62-block 11
call    0 returned 1077
branch  1 taken 1077 (fallthrough)
branch  2 taken 0 (throw)
    1077*:   63:    if ((err == UC_ERR_READ_UNMAPPED) && ((STACK_ADDRESS != 0) && (!showPopupError))) {
     1077:   63-block 12
branch  0 taken 0 (fallthrough)
branch  1 taken 1077
    %%%%%:   63-block 13
branch  2 never executed (fallthrough)
branch  3 never executed
    %%%%%:   63-block 14
branch  4 never executed (fallthrough)
branch  5 never executed
    #####:   64:        LOG_ERROR("Failed to read memory. Address: " << std::hex << STACK_ADDRESS);
    %%%%%:   64-block 15
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed
    %%%%%:   64-block 17
call    3 never executed
branch  4 never executed (fallthrough)
branch  5 never executed
    %%%%%:   64-block 19
call    6 never executed
branch  7 never executed (fallthrough)
branch  8 never executed (throw)
    %%%%%:   64-block 20
call    9 never executed
branch 10 never executed (fallthrough)
branch 11 never executed (throw)
    %%%%%:   64-block 21
call   12 never executed
call   13 never executed
call   14 never executed
branch 15 never executed (fallthrough)
branch 16 never executed (throw)
    %%%%%:   64-block 24
call   17 never executed
branch 18 never executed (fallthrough)
branch 19 never executed (throw)
    %%%%%:   64-block 25
    %%%%%:   64-block 27
call   20 never executed
branch 21 never executed (fallthrough)
branch 22 never executed (throw)
    %%%%%:   64-block 28
call   23 never executed
branch 24 never executed (fallthrough)
branch 25 never executed (throw)
    %%%%%:   64-block 29
call   26 never executed
branch 27 never executed (fallthrough)
branch 28 never executed (throw)
    %%%%%:   64-block 30
call   29 never executed
branch 30 never executed (fallthrough)
branch 31 never executed (throw)
    %%%%%:   64-block 31
call   32 never executed
branch 33 never executed (fallthrough)
branch 34 never executed (throw)
    %%%%%:   64-block 32
call   35 never executed
branch 36 never executed (fallthrough)
branch 37 never executed (throw)
    %%%%%:   64-block 33
call   38 never executed
branch 39 never executed (fallthrough)
branch 40 never executed (throw)
    %%%%%:   64-block 34
call   41 never executed
branch 42 never executed (fallthrough)
branch 43 never executed (throw)
    %%%%%:   64-block 35
call   44 never executed
call   45 never executed
    %%%%%:   64-block 38
call   46 never executed
call   47 never executed
    %%%%%:   64-block 41
call   48 never executed
branch 49 never executed
branch 50 never executed (fallthrough)
    $$$$$:   64-block 68
call   51 never executed
    $$$$$:   64-block 70
call   52 never executed
    $$$$$:   64-block 74
    $$$$$:   64-block 75
    $$$$$:   64-block 76
    $$$$$:   64-block 77
call   53 never executed
    $$$$$:   64-block 79
    $$$$$:   64-block 80
call   54 never executed
    $$$$$:   64-block 82
    #####:   65:        stackErrorAddr = STACK_ADDRESS;
    #####:   66:        showPopupError = true;
    #####:   67:        ImGui::PopFont();
    %%%%%:   67-block 43
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed (throw)
    #####:   68:        return;
    %%%%%:   68-block 44
        -:   69:    }
        -:   70:
     1077:   71:    if (showPopupError){
     1077:   71-block 45
branch  0 taken 0 (fallthrough)
branch  1 taken 1077
    #####:   72:        if (!stackErrorPopup()) {
    %%%%%:   72-block 46
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed (throw)
    %%%%%:   72-block 47
branch  3 never executed (fallthrough)
branch  4 never executed
    #####:   73:            STACK_ADDRESS = DEFAULT_STACK_ADDRESS;
    #####:   74:            if (!isCodeRunning) {
    %%%%%:   74-block 48
branch  0 never executed (fallthrough)
branch  1 never executed
    #####:   75:                tempRegisterValueMap[getArchSBPStr(codeInformation.mode).first] = "0x00";
    %%%%%:   75-block 49
call    0 never executed
branch  1 never executed (fallthrough)
branch  2 never executed (throw)
    %%%%%:   75-block 50
call    3 never executed
branch  4 never executed (fallthrough)
branch  5 never executed (throw)
    %%%%%:   75-block 51
call    6 never executed
branch  7 never executed (fallthrough)
branch  8 never executed (throw)
    %%%%%:   75-block 52
call    9 never executed
    $$$$$:   75-block 83
call   10 never executed
    $$$$$:   75-block 85
        -:   76:            }
        -:   77:        }
        -:   78:    }
     1077:   79:        showPopupError = false;
        -:   80:
     1077:   81:    if (updateStack) {
     1077:   81-block 54
branch  0 taken 102 (fallthrough)
branch  1 taken 975
      102:   82:        copyBigEndian(data, temp, STACK_SIZE);
      102:   82-block 55
call    0 returned 102
      102:   83:        updateStack = false;
        -:   84:    }
        -:   85:
     1077:   86:    stackEditor.HighlightColor = ImColor(59, 60, 79);
     1077:   86-block 57
call    0 returned 1077
call    1 returned 1077
branch  2 taken 1077 (fallthrough)
branch  3 taken 0 (throw)
    $$$$$:   86-block 86
     1077:   87:    stackEditor.OptShowAddWindowButton = false;
        -:   88:    // stackEditor.OptShowSetBaseAddrOption = true;
     1077:   89:    stackEditor.OptFillMemoryRange = true;
     1077:   90:    stackEditor.FillMemoryRange = fillMemoryWithBytePopup;
     1077:   91:    stackEditor.StackFashionAddrSubtraction = true;
        -:   92:
     1077:   93:    stackEditor.DrawWindow("Stack", reinterpret_cast<void *>(reinterpret_cast<uintptr_t>(data)), STACK_SIZE, STACK_ADDRESS + STACK_SIZE);
     1077:   93-block 59
call    0 returned 1077
branch  1 taken 1077 (fallthrough)
branch  2 taken 0 (throw)
     1077:   94:    ImGui::PopFont();
     1077:   94-block 60
call    0 returned 1077
branch  1 taken 1077 (fallthrough)
branch  2 taken 0 (throw)
     1077:   95:}
     1077:   95-block 61
     1077:   95-block 62
call    0 returned 1077
branch  1 taken 1077 (fallthrough)
branch  2 taken 0
    $$$$$:   95-block 87
call    3 never executed
